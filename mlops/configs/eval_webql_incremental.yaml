# WebQL Incremental Model Evaluation Configuration
# Evaluates the fine-tuned Llama-3.2-1B model

# Model to evaluate (will be set dynamically to latest trained model)
model_path: outputs/runs/latest/model
eval_dataset_path: ./data
eval_dataset_pattern: "converted_webql_*.jsonl"

# Evaluation settings
max_eval_samples: 20  # Quick evaluation on subset
eval_batch_size: 4  # Match training batch size
max_length: 384  # Match training max_length

# Output settings
output_dir: artifacts/metrics
save_predictions: true
save_detailed_metrics: true

# WebQL-specific evaluation metrics
metrics:
  - exact_match          # Perfect query match
  - syntax_validity      # Valid JSON5/YAML syntax
  - semantic_accuracy    # Functional equivalence
  - xpath_validity       # Valid XPath expressions
  - rouge1              # Token overlap
  - rouge2              # Bigram overlap
  - rougeL              # Longest common subsequence
  - bleu                # Precision-based metric

# WebQL syntax validation
syntax_checks:
  - json5_parse         # Can parse as JSON5
  - yaml_parse          # Can parse as YAML
  - required_fields     # Has @url, @steps, @xpath, @fields
  - xpath_syntax        # Valid XPath expressions

# Generation settings (match training config)
generation_config:
  max_new_tokens: 256
  do_sample: true
  temperature: 0.1      # Low temperature for consistent code generation
  top_p: 0.9
  repetition_penalty: 1.1
  pad_token_id: 0

# Incremental model evaluation
task_type: "incremental_evaluation"
domain: "web_scraping"
output_format: "json5_yaml"